<script>
var fontsLoaded = false;
function fonta() {
    console.log('fontsLoaded');
    fontsLoaded = true;
}
</script>

<link rel="stylesheet" onload="fonta()" href="http://typeface.nytimes.com/css/zam5nzz.css"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
<style>
    #canvas {
        border: 1px solid black;
    }
</style>
<script>
var $video, $fps, $newtext, $textPosition, canvas;


function initialize() {
    $video = $('#video')
        .mousedown(function(){this.play();})
        .mouseup(function(){this.pause();})
        .dblclick(function(){window.open('http://google.com');});

    $newtext = $('#new-text').keypress(function(e) {
        if (e.which == 13) {
            drawCanvas(this.value);
        }});
    $fps = $('#fps');
    $textPosition = $("#text-position");

    canvas = $('#canvas')[0];
    console.log('initialized!');
}

function clearCanvas(context) {
    context.clearRect(0, 0, canvas.width, canvas.height)
}

function drawCanvas(text) {
    var ctx = canvas.getContext('2d');
    ctx.textAlign = 'center';
    clearCanvas(ctx);
    var fillText = text;


    ctx.textBaseline = "top";
    ctx.font = "italic bold 32pt nyt-cheltenham";

    ctx.fillStyle = "#333";
    ctx.fillText(fillText, canvas.width/2, parseInt($textPosition.val()));
    while (!fontsLoaded) {
        console.log('mmwahahaha');
    }
    window.location = canvas.toDataURL();

}

$(document).ready(function() {
    initialize();
});

function play() {
    $video[0].playbackRate = parseFloat($fps.val());
    console.log('playing');
}

function sup() {
    console.log('work!');
}
</script>


<video id="video" src="1 Minute Countdown Film Style-Mobile.mp4"></video>
<button onclick="play()">PLAY</button>
<input id="fps" type="text" placeholder="fps"/>
<canvas id="canvas"></canvas>
<input id="new-text" type="text" onsubmit="drawCanvas(this.value)" placeholder="input text"/>
<select id="text-position">
    <option value="100">Lower Third</option>
    <option value="50">Middle Third</option>
    <option value="0">Top</option>
</select>

